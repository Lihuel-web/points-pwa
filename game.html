<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' fill='%230b1120'/%3E%3Ctext x='14' y='46' font-size='38' fill='%2393c5fd'%3EA%3C/text%3E%3C/svg%3E">
  <title>Team Games ‚Äî ASCII Suite</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: "Space Mono", "IBM Plex Mono", ui-monospace, SFMono-Regular, Consolas, "Liberation Mono", monospace; margin:0; background:#0b1120; color:#e2e8f0; transition: background 0.3s ease, color 0.3s ease; }
    header { display:flex; gap:12px; align-items:center; padding:12px 16px; background:#111827; border-bottom:1px solid #1f2937; position:sticky; top:0; z-index:10; }
    header h1 { margin:0; font-size:18px; color:#93c5fd; letter-spacing:0.4px; }
    main { max-width: 1200px; margin: 0 auto; padding: 16px; }
    .tag { font-size:12px; padding:2px 8px; border:1px solid #334155; border-radius:999px; background:#0f172a; color:#93c5fd; }
    .row { display:flex; align-items:center; gap:10px; flex-wrap:wrap }
    .col { display:flex; flex-direction:column; gap:10px }
    button { padding:8px 12px; border-radius:10px; border:1px solid #334155; background:#0f172a; color:#e2e8f0; cursor:pointer; transition: transform 0.12s ease, box-shadow 0.2s ease, background 0.2s ease; }
    button.primary { background:#1d4ed8; border-color:#1d4ed8; color:#fff }
    button.ghost { background:transparent; color:#93c5fd; }
    button:disabled { opacity:.6; cursor:not-allowed }
    button:hover:not(:disabled){ transform: translateY(-1px); }
    select { padding:6px 8px; border-radius:8px; background:#0f172a; color:#e2e8f0; border:1px solid #334155 }
    .card { background:#111827; border:1px solid #1f2937; border-radius:14px; padding:14px; margin:16px 0; box-shadow:0 16px 40px rgba(0,0,0,0.25); }
    .hud { display:flex; gap:12px; flex-wrap:wrap; margin-bottom:10px; }
    .hud .cell { background:#0f172a; border:1px solid #334155; border-radius:10px; padding:8px 10px; }
    pre.screen { white-space: pre; min-height: 360px; background:#0a0f1f; border:1px solid #1f2937; border-radius:10px; padding:12px; color:#9cf6ff; text-shadow:0 0 6px rgba(0,255,255,0.2), 0 0 12px rgba(124,244,255,0.18); letter-spacing:0.2px; }
    .help { color:#94a3b8; font-size:12px; margin-top:6px; }
    h2 { margin: 8px 0 4px; color:#93c5fd; font-size:18px; }
    h3 { margin: 6px 0 8px; color:#bfdbfe; font-size:14px; }
    table { width:100%; border-collapse: collapse; margin-top:8px; }
    th, td { border-bottom:1px solid #1f2937; padding:8px 6px; text-align:left }
    thead th { background:#0f172a; color:#93c5fd }
    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    @media (max-width: 980px){ .grid2{ grid-template-columns: 1fr; } }

    /* Cyberpunk neon theme */
    body.theme-cyber {
      background: radial-gradient(140% 140% at 20% 0%, rgba(126,34,206,0.35), transparent 45%), radial-gradient(140% 140% at 85% 20%, rgba(14,165,233,0.25), transparent 50%), #040712;
      color:#e8f5ff;
      text-shadow:0 0 10px rgba(0,255,255,0.12);
    }
    body.theme-cyber header {
      background: linear-gradient(90deg, rgba(12,16,36,0.9), rgba(18,24,54,0.9));
      border-bottom:1px solid rgba(124,244,255,0.25);
      box-shadow:0 16px 40px rgba(0,0,0,0.4), 0 0 18px rgba(124,244,255,0.2);
    }
    body.theme-cyber header h1 { color:#7cf4ff; text-shadow:0 0 14px rgba(124,244,255,0.5); }
    body.theme-cyber .tag {
      background: rgba(124,244,255,0.12);
      color:#7cf4ff;
      border-color: rgba(124,244,255,0.35);
      text-shadow:0 0 10px rgba(124,244,255,0.4);
    }
    body.theme-cyber button {
      background: rgba(10,14,30,0.9);
      color:#e8f5ff;
      border-color: rgba(124,244,255,0.3);
      box-shadow:0 0 16px rgba(124,244,255,0.25);
    }
    body.theme-cyber button.primary {
      background: linear-gradient(135deg, #7c3aed, #0ea5e9);
      border-color: rgba(126,34,206,0.55);
      box-shadow:0 0 18px rgba(126,34,206,0.4);
      color:#f9fbff;
    }
    body.theme-cyber select {
      background: rgba(8,12,28,0.9);
      border-color: rgba(124,244,255,0.28);
      color:#e8f5ff;
      box-shadow: inset 0 0 10px rgba(14,165,233,0.12);
    }
    body.theme-cyber .card {
      background: linear-gradient(145deg, rgba(10,12,30,0.95), rgba(14,20,50,0.92));
      border:1px solid rgba(124,244,255,0.2);
      box-shadow: 0 24px 60px rgba(0,0,0,0.5), 0 0 26px rgba(126,34,206,0.25);
    }
    body.theme-cyber .hud .cell,
    body.theme-cyber pre.screen {
      background: rgba(10,12,30,0.85);
      border-color: rgba(124,244,255,0.2);
      box-shadow: inset 0 0 16px rgba(14,165,233,0.14);
    }
    body.theme-cyber .help { color:#9cb7ff; }
    body.theme-cyber h2, body.theme-cyber h3 { color:#c8e5ff; text-shadow:0 0 10px rgba(124,244,255,0.35); }
    body.theme-cyber table { color:#e8f5ff; }
    body.theme-cyber thead th {
      background: rgba(124,244,255,0.1);
      color:#9cf3ff;
      border-bottom:1px solid rgba(124,244,255,0.25);
    }
    body.theme-cyber th, body.theme-cyber td { border-bottom:1px solid rgba(124,244,255,0.2); }
    body.theme-cyber table tbody td { color:#e8f5ff; text-shadow:0 0 6px rgba(0,255,255,0.25); font-weight:600; }
    body.theme-cyber table tbody tr { backdrop-filter: saturate(1.05); }

    .shortcut-card {
      display:flex; align-items:center; gap:10px;
      padding:10px 12px; border:1px solid #243048; border-radius:12px; background:#0f172a;
      color:#e2e8f0;
    }
    .shortcut-thumb { width:48px; height:48px; border-radius:10px; background:linear-gradient(135deg,#1d4ed8,#0ea5e9); }
    .shortcut-title { font-weight:700; }
    .flappy-thumb { background:linear-gradient(135deg,#38bdf8,#8b5cf6), url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text x=\"12\" y=\"44\" font-size=\"32\">üê¶</text></svg>') center/70% no-repeat; }
    .snake-thumb  { background:linear-gradient(135deg,#22c55e,#0ea5e9), url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text x=\"12\" y=\"44\" font-size=\"32\">üêç</text></svg>') center/70% no-repeat; }
    .tetris-thumb { background:linear-gradient(135deg,#f59e0b,#6366f1), url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text x=\"10\" y=\"44\" font-size=\"32\">üßä</text></svg>') center/70% no-repeat; }
    .road-thumb   { background:linear-gradient(135deg,#f43f5e,#14b8a6), url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><text x=\"10\" y=\"44\" font-size=\"32\">üöó</text></svg>') center/70% no-repeat; }

    .lb-scroll { max-height: 240px; overflow: auto; border:1px solid #1f2937; border-radius:10px; }
    body.theme-cyber .lb-scroll { border-color: rgba(124,244,255,0.2); box-shadow: inset 0 0 12px rgba(124,244,255,0.15); }
    .volume-slider { width: 90px; accent-color:#1d4ed8; }
    body.theme-cyber .volume-slider { accent-color:#7cf4ff; }
    .volume-label { font-size:12px; color:#94a3b8; }
  </style>
</head>
  <body>
    <header>
      <h1>ASCII Classroom Games</h1>
      <span class="tag">read-only (system points do not change)</span>
      <div class="row" style="margin-left:auto">
        <div class="row" style="gap:6px; align-items:center;">
          <button id="audio-toggle" class="ghost">Mute</button>
          <label for="audio-volume" class="volume-label">Vol</label>
          <input id="audio-volume" type="range" min="0" max="100" step="5" value="100" class="volume-slider" />
        </div>
        <button id="theme-toggle-game" class="ghost">Neon mode</button>
        <a href="./index.html"><button>‚Üê Back</button></a>
      </div>
    </header>

  <main>
    <!-- Game shortcuts -->
    <section class="card">
      <h3>Jump to a game</h3>
      <div class="row" style="gap:12px; flex-wrap:wrap;">
        <a href="#flappy" class="shortcut-card" style="text-decoration:none;">
          <div class="shortcut-thumb flappy-thumb"></div>
          <div class="shortcut-title">ASCII Flappy</div>
        </a>
        <a href="#snake" class="shortcut-card" style="text-decoration:none;">
          <div class="shortcut-thumb snake-thumb"></div>
          <div class="shortcut-title">ASCII Snake</div>
        </a>
        <a href="#tetris" class="shortcut-card" style="text-decoration:none;">
          <div class="shortcut-thumb tetris-thumb"></div>
          <div class="shortcut-title">ASCII Tetris</div>
        </a>
        <a href="#road" class="shortcut-card" style="text-decoration:none;">
          <div class="shortcut-thumb road-thumb"></div>
          <div class="shortcut-title">ASCII Road</div>
        </a>
      </div>
    </section>

    <!-- Common block -->
    <section class="card">
      <div class="row">
        <div class="tag">User: <span id="common-user">‚Äî</span></div>
        <div class="tag">Local: <span id="common-local">‚Äî</span></div>
        <div class="tag">Global: <span id="common-pool">‚Äî</span></div>
        <div class="tag">Pool: <span id="common-poolpts">0</span></div>
        <div class="tag">Spent: <span id="common-spent">0</span></div>
        <div class="tag">Total (local): <span id="common-total">0</span></div>
      </div>
      <div class="help">Play time per game = <strong>Total (local)</strong> (max 240 s). Changing difficulty does not affect system points, only the game.</div>
    </section>

    <!-- ==== JUEGO 1: FLAPPY ==== -->
    <section class="card" id="flappy">
      <h2>ASCII Flappy</h2>
      <div class="hud">
        <div class="cell"><strong>Play time:</strong> <span id="flappy-time">0</span> s</div>
        <div class="cell"><strong>Score:</strong> <span id="flappy-score">0 ‚Üí √ó1.25</span></div>
        <div class="cell"><strong>Total score:</strong> <span id="flappy-total">0</span></div>
        <div class="cell"><strong>Difficulty:</strong> <span id="flappy-diff">normal √ó1.25</span></div>
        <div class="cell"><strong>Status:</strong> <span id="flappy-status">loading‚Ä¶</span></div>
      </div>
      <div class="row">
        <label>Difficulty:
          <select id="flappy-select">
            <option value="easy">easy √ó1.00</option>
            <option value="normal" selected>normal √ó1.25</option>
            <option value="hard">hard √ó1.60</option>
            <option value="insane">insane √ó2.00</option>
          </select>
        </label>
        <button id="flappy-start" class="primary" disabled>Start</button>
        <button id="flappy-stop" disabled>Stop</button>
        <span class="tag">Controls: Space/‚Üë jump ¬∑ P pause</span>
      </div>
      <div class="row">
        <label>Gravity tweak (¬±20%):
          <input type="range" id="flappy-gravity" min="80" max="120" step="1" value="100" class="volume-slider" />
        </label>
        <span class="tag" id="flappy-gravity-planet">Earth - 9.81 m/s^2</span>
        <span class="tag" id="flappy-gravity-current">100% -> 9.81 m/s^2</span>
      </div>
      <div class="help" id="flappy-gravity-note">Base gravity uses real planets (easy = Moon, normal = Earth).</div>
      <pre id="flappy-screen" class="screen">Loading‚Ä¶</pre>
      <div class="help">Final score = obstacles cleared √ó multiplier. System points do not change.</div>
      <div class="row">
        <label>Rows to show:
          <input type="range" id="flappy-lb-limit" min="5" max="50" step="5" value="10" />
          <span id="flappy-lb-limit-val">10</span>
        </label>
      </div>

      <div class="grid2">
        <div>
          <h3>Leaderboard ‚Äî best scores (your local team)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Student</th><th>Best</th></tr></thead><tbody id="flappy-lb-local"></tbody></table></div>
        </div>
        <div>
          <h3>Leaderboard ‚Äî local teams (global, best individual)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Local team</th><th>Global</th><th>Player</th><th>Team best</th></tr></thead><tbody id="flappy-lb-teams"></tbody></table></div>
        </div>
      </div>
    </section>

    <!-- ==== JUEGO 2: SNAKE ==== -->
    <section class="card" id="snake">
      <h2>ASCII Snake</h2>
      <div class="hud">
        <div class="cell"><strong>Play time:</strong> <span id="snake-time">0</span> s</div>
        <div class="cell"><strong>Score:</strong> <span id="snake-score">0 kg -> x1.25</span></div>
        <div class="cell"><strong>Total score:</strong> <span id="snake-total">0</span></div>
        <div class="cell"><strong>Speed:</strong> <span id="snake-speed">0 cm/s</span></div>
        <div class="cell"><strong>Weight:</strong> <span id="snake-weight">0 kg</span></div>
        <div class="cell"><strong>Difficulty:</strong> <span id="snake-diff">normal √ó1.25</span></div>
        <div class="cell"><strong>Status:</strong> <span id="snake-status">loading‚Ä¶</span></div>
      </div>
      <div class="row">
        <label>Difficulty:
          <select id="snake-select">
            <option value="easy">easy √ó1.00</option>
            <option value="normal" selected>normal √ó1.25</option>
            <option value="hard">hard √ó1.60</option>
            <option value="insane">insane √ó2.00</option>
          </select>
        </label>
        <button id="snake-start" class="primary" disabled>Start</button>
        <button id="snake-stop" disabled>Stop</button>
        <span class="tag">Controls: ‚Üê ‚Üí ‚Üë ‚Üì move ¬∑ P pause</span>
      </div>
      <pre id="snake-screen" class="screen">Loading‚Ä¶</pre>
      <div class="help">Eat ‚Äú*‚Äù to add weight (score = kg). Avoid walls/obstacles/body; weight slows speed (capped at -40%). Obstacles spawn on normal+.</div>
      <div class="row">
        <label>Rows to show:
          <input type="range" id="snake-lb-limit" min="5" max="50" step="5" value="10" />
          <span id="snake-lb-limit-val">10</span>
        </label>
      </div>

      <div class="grid2">
        <div>
          <h3>Leaderboard ‚Äî best scores (your local team)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Student</th><th>Best</th></tr></thead><tbody id="snake-lb-local"></tbody></table></div>
        </div>
        <div>
          <h3>Leaderboard ‚Äî local teams (global, best individual)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Local team</th><th>Global</th><th>Player</th><th>Team best</th></tr></thead><tbody id="snake-lb-teams"></tbody></table></div>
        </div>
      </div>
    </section>

    <!-- ==== JUEGO 3: TETRIS (simplificado ASCII) ==== -->
    <section class="card" id="tetris">
      <h2>ASCII Tetris (simplificado)</h2>
      <div class="hud">
        <div class="cell"><strong>Play time:</strong> <span id="tetris-time">0</span> s</div>
        <div class="cell"><strong>Score:</strong> <span id="tetris-score">0 ‚Üí √ó1.25</span></div>
        <div class="cell"><strong>Total score:</strong> <span id="tetris-total">0</span></div>
        <div class="cell"><strong>Difficulty:</strong> <span id="tetris-diff">normal √ó1.25</span></div>
        <div class="cell"><strong>Status:</strong> <span id="tetris-status">loading‚Ä¶</span></div>
      </div>
      <div class="row">
        <label>Difficulty:
          <select id="tetris-select">
            <option value="easy">easy √ó1.00</option>
            <option value="normal" selected>normal √ó1.25</option>
            <option value="hard">hard √ó1.60</option>
            <option value="insane">insane √ó2.00</option>
          </select>
        </label>
        <button id="tetris-start" class="primary" disabled>Start</button>
        <button id="tetris-stop" disabled>Stop</button>
        <span class="tag">Controls: ‚Üê ‚Üí move ¬∑ ‚Üë rotate ¬∑ ‚Üì drop faster ¬∑ P pause</span>
      </div>
      <pre id="tetris-screen" class="screen">Loading‚Ä¶</pre>
      <div class="help">Score from cleared lines. Simplified for ASCII (I, O, L, T pieces).</div>
      <div class="row">
        <label>Rows to show:
          <input type="range" id="tetris-lb-limit" min="5" max="50" step="5" value="10" />
          <span id="tetris-lb-limit-val">10</span>
        </label>
      </div>

      <div class="grid2">
        <div>
          <h3>Leaderboard ‚Äî best scores (your local team)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Student</th><th>Best</th></tr></thead><tbody id="tetris-lb-local"></tbody></table></div>
        </div>
        <div>
          <h3>Leaderboard ‚Äî local teams (global, best individual)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Local team</th><th>Global</th><th>Player</th><th>Team best</th></tr></thead><tbody id="tetris-lb-teams"></tbody></table></div>
        </div>
      </div>
    </section>

    <!-- ==== JUEGO 4: ROAD (tipo Road Fighter ASCII) ==== -->
    <section class="card" id="road">
      <h2>ASCII Road</h2>
      <div class="hud">
        <div class="cell"><strong>Play time:</strong> <span id="road-time">0</span> s</div>
        <div class="cell"><strong>Score:</strong> <span id="road-score">0 ‚Üí √ó1.25</span></div>
        <div class="cell"><strong>Total score:</strong> <span id="road-total">0</span></div>
        <div class="cell"><strong>Difficulty:</strong> <span id="road-diff">normal √ó1.25</span></div>
        <div class="cell"><strong>Status:</strong> <span id="road-status">loading‚Ä¶</span></div>
      </div>
      <div class="row">
        <label>Difficulty:
          <select id="road-select">
            <option value="easy">easy √ó1.00</option>
            <option value="normal" selected>normal √ó1.25</option>
            <option value="hard">hard √ó1.60</option>
            <option value="insane">insane √ó2.00</option>
          </select>
        </label>
        <button id="road-start" class="primary" disabled>Start</button>
        <button id="road-stop" disabled>Stop</button>
        <span class="tag">Controls: ‚Üê ‚Üí move ¬∑ P pause</span>
      </div>
      <pre id="road-screen" class="screen">Loading‚Ä¶</pre>
      <div class="help">Avoid falling obstacles. Score by distance/obstacles dodged.</div>
      <div class="row">
        <label>Rows to show:
          <input type="range" id="road-lb-limit" min="5" max="50" step="5" value="10" />
          <span id="road-lb-limit-val">10</span>
        </label>
      </div>

      <div class="grid2">
        <div>
          <h3>Leaderboard ‚Äî best scores (your local team)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Student</th><th>Best</th></tr></thead><tbody id="road-lb-local"></tbody></table></div>
        </div>
        <div>
          <h3>Leaderboard ‚Äî local teams (global, best individual)</h3>
          <div class="lb-scroll"><table><thead><tr><th>#</th><th>Local team</th><th>Global</th><th>Player</th><th>Team best</th></tr></thead><tbody id="road-lb-teams"></tbody></table></div>
        </div>
      </div>
    </section>
  </main>

  <script>
    window.SUPABASE_URL = "https://rmhwafuymxcicxaructc.supabase.co";
    window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJtaHdhZnV5bXhjaWN4YXJ1Y3RjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MzAxNDcsImV4cCI6MjA3MTIwNjE0N30.u3p-n0mwER9jXvfefuG8VASFPa6TKUlCaYVbp4TW9-w";
  </script>
  <script type="module" src="./game.js"></script>
</body>
</html>
